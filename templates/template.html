<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BİT Durum Raporu</title>
    <style>
        /* templates/style.css */

/* --- 1. Global Ayarlar --- */
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    background-color: #f8f9fa; /* Hafif gri arka plan */
    color: #343a40; /* Koyu gri metin */
    margin: 0;
    padding: 20px;
}

/* --- 2. Ana Konteyner --- */
.container {
    max-width: 1200px;
    margin: 0 auto;
    background: #ffffff;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    overflow: hidden; /* Kenar yuvarlaklıklarını korumak için */
}

/* --- 3. Başlık Alanı --- */
.header {
    padding: 24px 32px;
    border-bottom: 1px solid #e9ecef;
}

.header h1 {
    margin: 0;
    color: #212529;
    font-size: 1.75rem;
}

.header p {
    margin: 4px 0 0;
    font-size: 0.9rem;
    color: #6c757d; /* Nötr gri */
}

/* --- 4. Ana İçerik Alanı --- */
main {
    padding: 32px;
}

h2 {
    font-size: 1.25rem;
    color: #007bff; /* Ana Mavi Renk */
    border-bottom: 2px solid #dee2e6;
    padding-bottom: 8px;
    margin-top: 0;
    margin-bottom: 24px;
}

/* --- 5. KPI Kartları (Dashboard Görünümü) --- */
.kpi-grid {
    display: grid;
    /* 200px'lik kartlar sığdığı kadar yan yana, sığmazsa alt satıra at */
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 32px;
}

.kpi-card {
    background: #fdfdfd;
    border: 1px solid #e9ecef;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.03);
}

.kpi-card .label {
    font-size: 0.9rem;
    color: #6c757d;
    margin-bottom: 8px;
}

.kpi-card .number {
    font-size: 2.25rem;
    font-weight: 700;
    color: #212529;
}

/* Kartlara özel vurgu renkleri */
.kpi-card.danger .number {
    color: #dc3545; /* Kırmızı */
}
.kpi-card.warning .number {
    color: #ffc107; /* Sarı */
}
.kpi-card.success .number {
    color: #28a745; /* Yeşil */
}


/* --- 6. Tablo Stilleri --- */
.table-wrapper {
    overflow-x: auto; /* Küçük ekranlarda tabloyu kaydırılabilir yap */
}

table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

th, td {
    padding: 12px 16px;
    border-bottom: 1px solid #dee2e6;
    text-align: left;
    vertical-align: middle;
}

thead th {
    background-color: #f1f3f5; /* Tablo başlığı için hafif gri */
    color: #495057;
    font-weight: 600;
    font-size: 0.9rem;
    text-transform: uppercase;
}

tbody tr:nth-child(even) {
    background-color: #fcfcfc;
}

tbody tr:hover {
    background-color: #f0f6ff; /* Üzerine gelince mavi vurgu */
}

/* --- 7. Durum Etiketleri (Badges) --- */
.badge {
    padding: 4px 10px;
    border-radius: 16px;
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
}

.badge-danger {
    background-color: #fbebee;
    color: #c62828;
}

.badge-success {
    background-color: #e6f7ec;
    color: #1e8e3e;
}

.badge-secondary {
    background-color: #e9ecef;
    color: #495057;
}
    </style>
</head>
<body>

    <div class="container">
        <header class="header">
            <h1>BİT Durum Raporu</h1>
            <p>Rapor Oluşturma Tarihi: {{ rapor_tarihi }}</p>
        </header>

        <main>
            <section class="kpi-grid">
                <div class="kpi-card">
                    <div class="label">Toplam Cihaz</div>
                    <div class="number">{{ stats.toplam_cihaz }}</div>
                </div>
                
                {% set ariza_class = 'success' if stats.acik_ariza_sayisi == 0 else 'danger' %}
                <div class="kpi-card {{ ariza_class }}">
                    <div class="label">Açık Arıza Kaydı</div>
                    <div class="number">{{ stats.acik_ariza_sayisi }}</div>
                </div>

                {% set depo_class = 'secondary' if stats.cihaz_durum_dagilimi.Depoda > 0 else 'success' %}
                <div class="kpi-card {{ depo_class }}">
                    <div class="label">Depodaki Cihaz</div>
                    <div class="number">{{ stats.cihaz_durum_dagilimi.Depoda | default(0) }}</div>
                </div>
            </section>

            <section>
                <h2>Aktif Açık Arıza Kayıtları</h2>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Cihaz ID</th>
                                <th>Cihaz Türü</th>
                                <th>Marka/Model</th>
                                <th>Arıza Açıklaması</th>
                                <th>Bildiren</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for ariza in acik_arizalar_listesi %}
                            <tr>
                                <td>{{ ariza.CihazID }}</td>
                                <td>{{ ariza.CihazTuru }}</td>
                                <td>{{ ariza.MarkaModel }}</td>
                                <td>{{ ariza.Aciklama }}</td>
                                <td>{{ ariza.Bildiren }}</td>
                            </tr>
                            {% else %}
                            <tr>
                                <td colspan="5">Aktif arıza kaydı bulunamadı.</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </section>
            
            <section style="margin-top: 32px;">
                <h2>Tüm Envanter Listesi</h2>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Cihaz ID</th>
                                <th>Cihaz Türü</th>
                                <th>Marka/Model</th>
                                <th>Zimmetli Personel</th>
                                <th>Durum</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for envanter in tum_envanter_listesi %}
                            <tr>
                                <td>{{ envanter.CihazID }}</td>
                                <td>{{ envanter.CihazTuru }}</td>
                                <td>{{ envanter.MarkaModel }}</td>
                                <td>{{ envanter.ZimmetliPersonel }}</td>
                                <td>
                                    {% set durum_class = 'badge-secondary' %}
                                    {% if envanter.Durum == 'Aktif' %}
                                        {% set durum_class = 'badge-success' %}
                                    {% elif envanter.Durum == 'Arızalı' %}
                                        {% set durum_class = 'badge-danger' %}
                                    {% endif %}
                                    <span class="badge {{ durum_class }}">{{ envanter.Durum }}</span>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </section>
        </main>
    </div>

</body>
</html>